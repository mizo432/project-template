履歴データの標準化
-----

# 平準化手順

1. 完全重複期間の排除
2. 連続データの統合
3. 完全重複期間の排除
4. オーバーラップ期間の統合
5. 完全重複期間の排除
6. 終了補正

## データ選択の戦略

ItemSelectPriority

* 前データ選択
* 後データ選択

# 完全重複期間の排除

期間の開始、終了が一致しているitemが連続している場合にデータ選択の戦略に従い排除します。

## 前データ選択の場合

### 標準化前

| start | finish | data |
|-------|--------|------|
| 2022  | 2023   | A    |
| 2022  | 2023   | A    |
| 2022  | 2023   | A    |

### 標準化後

| start | finish | data |
| ----- | ------ | ---- |
| 2022  | 2023   | A    |

## 後データ選択

### 標準化前

| start | finish | data |
|-------|--------| ---- |
| 2022  | 2023   | A    |
| 2022  | 2023   | B    |
| 2022  | 2023   | C    |

### 標準化後

| start | finish | data |
| ----- | ------ |------|
| 2022  | 2023   | C    |

# 2.連続データの統合

データが一致していて、期間がオーバーラップしている場合、オーバーラップしている期間を統合します。

## 前データ選択/後データ選択

### 標準化前

| start | finish | data |
|-------|--------|------|
| 2022  | 2023   | A    |
| 2024  | 2025   | A    |
| 2026  | 2027   | A    |
| 2029  | 2029   | A    |
| 2031  | 2032   | B    |
| 2033  | 2034   | B    |

### 標準化後

| start | finish  | data |
|-------|---------|-----|
| 2022  | 2027    | A   |
| 2029  | 2029    | A   |
| 2031  | 2034    | B   |

# 3. オーバーラップ期間の統合

## 前データ選択

### 標準化前

| start | finish | data |
|-------|--------|------|
| 2022  | 2023   | A    |
| 2023  | 2025   | B    |
| 2026  | 2027   | C    |

### 標準化後

| start | finish | data |
|-------|--------|------|
| 2022  | 2023   | A    |
| 2024  | 2025   | B    |
| 2026  | 2027   | C    |

## 後データ選択

### 標準化前

| start | finish | data |
|-------|--------| ---- |
| 2022  | 2023   | A    |
| 2023  | 2025   | B    |
| 2026  | 2017   | C    |

### 標準化後

| start | finish | data |
|-------|--------|------|
| 2022  | 2022   | A    |
| 2023  | 2025   | B    |
| 2026  | 2027   | C    |

# 6. 終了補正

データの一致に関わらす期間がオーバーラップしている場合

## 前データ選択/後データ選択

### 標準化前

| start | finish | data |
|-------|--------|------|
| 2022  | 9999   | A    |
| 2024  | 9999   | B    |
| 2026  | 9999   | C    |
| 2029  | 9999   | D    |

### 標準化後

| start | finish | data |
|-------|--------| ---- |
| 2022  | 2023   | A    |
| 2024  | 2025   | B    |
| 2026  | 2028   | C    |
| 2029  | 9999   | D    |

