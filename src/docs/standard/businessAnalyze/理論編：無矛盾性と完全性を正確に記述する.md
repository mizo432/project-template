理論編：無矛盾性と完全性を正確に記述する
=====
* 認知されたNO、コードごとに箱（entity）を作り、性質（attribute）を振り分ける
  * 性質が何に帰属するか明らかになる
  * 勝手なNOやコードを書かない
* 箱（entity）は事態（event)と主題（resource）で分ける
* 箱を線（関係）でつなぐ
* データの区分構成を確認する
  * 区分が排他的ORであり、包摂（包含）関係が妥当であるか
  * 区分は集合を切断するためのものか
* データの多値構成を確認する
  * OR（排他的OR）か、ANDか区別する
* クラス
  * 箱に帰属する性質であるか確認する
  * 箱と箱の間にある制約束縛が他の箱と関係を為さないか確認する

# TMでなければダメなのか？
* TMでなくてもよい
* うまくいっているところは、だいたい同じようなチェックがされている
* ツール、方法論独自の方法で無矛盾性と完全性が保証されている
* TMは正規形を現場に正しく適用しようとしているだけ
  * ER図だけでなく、RDBすらも正規形を表せていない
  * セット理論だけでなく、クラス理論も取り入れて、正規形を補足する

# モデリングのポイント
* 現実的事態（事業過程、管理過程）を記述する
  * 正当化条件、構成条件を網羅する
  * ユーザー言語（現実的事態）を変形せず、出来るだけ機械的に書く
* 正確に記述して、証明可能（検証可能）であること
  * 無矛盾性（論理法則）
  * 完全性（意味として正しい）
* 形式的構造＝個体＋関係
  * 2つのアプローチ
    * 実態主義：　個体ありき、関係は二次的（ユーザーの言葉）
    * 関係主義：　関係ありき、個体は付値（関数）（データモデル、科学分析）
* TMは関係主義
  * 個体＝無定義語（パラメータ）
  * 個体の解釈は現実的事態（関係）で異なり、現実的事態（関係）だけが個体の意義を定める

# モデルの構成規則
* 生成規則（構造論）
  * 文法、論理法則によって表された形式的構成
  * 健全性、無矛盾性を保証する
  * 無矛盾性だけを証明しても、正しいこと（完全性）が証明されたとはいえない
  * 現実的事態（事業思想、管理思想）に対する解釈（ユーザーの自然言語そのまま）のこと
* 指示規則（意味論）
  * 解釈、現実的事態によって表された形式的構造
  * 完全性を保証する
  * 解釈によって表された形式的構造であり、現実的事態のこと
    * 関係の網羅性の確認、制約束縛（アトリビュートリスト）

# モデリングの進め方

<table>
    <thead>
        <tr>
            <th colspan="2">観点</th>
            <th>フェーズ</th>
            <th>方法・手順</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td rowspan="5">生成規則（構文論）</td>
            <td rowspan="3">文法</td>
            <td rowspan="3">事業分析</td>
            <td>1. 個体の認知</td>
        </tr>
        <tr>
            <td>2. 関係の性質（データの並び）</td>
        </tr>
        <tr>
            <td>3. 関係の文法</td>
        </tr>
        <tr>
            <td rowspan="2">データの検証</td>
            <td rowspan="2">設計</td>
            <td>4. データの周延</td>
        </tr>
        <tr>
            <td>5. データの多値</td>
        </tr>
        <tr>
            <td>指示規則（意味論）</td>
            <td>意味論</td>
            <td>製造</td>
            <td>6. クラス</td>
        </tr>
    </tbody>
</table>


* 手順１～５は一般手続きがある
  * 誰が書いても同じになる
  * 誰が書いても同じようになるように、勝手な解釈をいれない
* 手順6は一般手続きがない
  * 何をクラスとしてまとめるかは恣意的

# 個体の認知
* ヒアリングした内容や、現行システムの画面、帳票などを元に、認知されたNO、コードごとに箱（entity）を作り、性質（attribute）を振り分ける
  * ここで書かれたNOやコードがユーザ言語であり、合意されたもの(認知単位）
  * 箱を書いたときに対応するNOやコードがないからと言って、勝手な項目を書いてはいけない（合意されていない）
  * 名前（修飾子）をもとに、性質を考え、わからないものは確認して、振り分ける
* ユニーク（一意性）にするためのキーを作るのではない
  * NO、コードは箱そのものを表すので、1つだけで認識できる
  * 複合キーは関係によってのみ現れる
    * 箱を複合キーで認識すると、論理が隠れてしまう
  * 性質が箱に帰属する単位がわかることがポイント
  * 第1正規形では「スカラのみで成り立つもの」としている
  * 一意性を保証するために作ってしまうと、変更が困難になったり、RDBの制約 （インデックス、探査ルールなど）を受けて、逆に遅くなってしまう

# 問題のあるケース
* 「青色」や「12cm」は定義できない
– 事業によっては分類や型紙として合意している場合もある
– 合意されていない場合は、他の箱の性質でしかない
*  合成キーは帰属先がわからない
  * JANコードは世間で認知されているからよいだろう
  * 「大分類（3桁）＋中分類＋（3桁）＋小分類（3桁）」からなる商品コードは作るべきではない
    * 現実の事態を表せているかもしれないが、業態を変えることが困難になってしまう
    * こういった項目は項目名の右側に「*」をつけてチェックしておく
*  複合キー（社員番号＋組織番号）は関係を隠してしまう
*  性別は箱にならない
  * 性質がないものは箱にならない（性別ごとの染色体の数を管理するような事業ならば箱になるかもしれない）
  * 性質がないものは区分コード（性質）かもしれない

# 関係の性質（データの並び）

* 関係には、対称性（半順序）と非対称性（全順序）があり、区別しなければならない
  * 非対称性：　並び替えても意味が通る
    * 愛川欽也と佳村萌には親子関係がある
  * 対称性：　並び替えると意味が通らない
    * 愛川欽也は佳村萌の親である
* コッドの正規形は全順序ののみを対象としており、半順序を対象外としている
  * ビジネスの実態は半順序だらけ
  * 全順序と半順序の関係は別物である
  * 半順序を定義できなかった
    * 全順序は定義できた
    * 半順序は全順序の補集合だといえる
* 箱／個体（entity）を事態（event)と主題（resource）で分ける
  * 箱の右上に「E」、または「R」をつける
* 個体（entity）
  * 事態（case, event：以下、Eまたはeventと記す）
    * 行為や出来事
    * 非対称性（全順序）
    *「並びがある」とは「並べる基準」があること
      * 日付が並べる基準、すなわち、日付の有無が全順序の定義となる
        * 前後関係を表す日付のみが全順序の条件となる
        * 誕生日や更新日、適用日などはただの性質の一つ
  * 主題（subject, resource：以下、Rまたはresourceと記す）
    * 行為者
    * 対称性（半順序）
    * 事態の補集合が主題となりうる

# 関係の文法
<table>
    <thead>
        <tr>
            <th rowspan="2">集合</th>
            <th rowspan="2">種類</th>
            <th colspan="2">文法</th>
        </tr>
        <tr>
            <th>1 対 1</th>
            <th>複数 対 複数</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td rowspan="3">2つの集合の間</td>
            <td>R-E</td>
            <td>R(主体)がE(事態)に関与する</td>
            <td>クラス理論（多値）</td>
        </tr>
        <tr>
            <td>E-E</td>
            <td>先行・後続</td>
            <td>対応表（マッピングリスト）</td>
        </tr>
        <tr>
            <td>R-R</td>
            <td colspan="2">対象表（データディクショナリー/制約束縛）</td>
        </tr>
        <tr>
            <td>2つの集合の間</td>
            <td>再帰</td>
            <td colspan="2">メンバーを並べる(先行・後続関係)</td>
        </tr>
    </tbody>
</table>

* 全ての箱と箱の間に関係があるか確認する（網羅性）
  * 関係がある箱の間に線を引く
    * 線(関係）が重要
    * 線が箱の意義を定め、線の数だけ意義がある
  * 関係によって生まれたentityには個体指定子は存在しない
  * 関与するresource、eventの個体指定子があるだけ
    * 区別して、個体指定子の後に(R)を付ける
    * RとはRe-Useのことであり、Referenceではない

https://www.sea.jp/Events/symposium/ss2009/contents/07-Modeling/ss2009-modeling-slide-tokimoto.pdf