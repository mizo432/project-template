データベース設計
=====

# モチベーション

業務フローから業務で設定する項目を整理する

# データベースの概念化[ER分析]

* 業務フローから業務で使用する用語を整理する。
* エンティティーが何でユニーク(単一)になるのかを明確にする。
* アトリビュートがどのエンティティーに存在するのかを明らかにする。
* ドメインを明確にする。

# リソースに変更証跡が必要な場合の対応

データベースへの落とし込み前にエンティティに履歴が必要かを検討し必要な場合は履歴として保持できるように落とし込む。

# データベースへの落とし込み

リソースとイベントに関しては単純なためその他のテーブル類を整理する。

## リソース

リソースは要件上世代または変更履歴を持つかによって設計を分ける。

リソース
| 促成 | カラム名 | | |
|:----|------|-------|--------|
| リソースID | ResourceId | | |
| リソースコード | ResourceCode | | |
| リソース名 | ResourceName | | |

|     |     | 履歴要   | 履歴否    |
|:----|-----|-------|--------|
| 世代  | 要   | パターン① | パターン ② |
|     | 否   | パターン③ | パターン④　 |

### パターン①

世代管理要、履歴管理要

#### リソース履歴

| 促成     | カラム名       | 摘要  | 備考  |
|:-------|------------|-----|-----|
| リソースID | ResourceId |     |     |

#### リソース摘要開始

| 促成      | カラム名          | 摘要  | 備考  |
|:--------|---------------|-----|-----|
| リソースID  | ResourceId    |     |     |
| 開始日次    | StartDateTime |     |     |
| リソースコード | ResourceCode  |     |     |
| リソース名   | ResourceName  |     |     |

#### リソース適用終了

| 促成     | カラム名        |     |     |
|:-------|-------------|-----|-----|
| リソースID | ResourceId  |     |     |
| 終了日時   | EndDateTime |     |     |

#### 現在 リソース materialized viewで用意する

| 促成      | カラム名         |     |     |
|:--------|--------------|-----|-----|
| リソースID  | ResourceId   |     |     |
| リソースコード | ResourceCode |     |     |
| リソース名   | ResourceName |     |     |

#### リソース世代 materialized viewで用意する

| 促成      | カラム名         |     |     |
|:--------|--------------|-----|-----|
| リソースID  | ResourceId   |     |     |
| 開始日付    | StartDate    |     |     |
| 終了日付    | EndDate      |     |     |
| リソースコード | ResourceCode |     |     |
| リソース名   | ResourceName |     |     |

####      

## イベント 年度別に

| 促成        | カラム名                 |     |     |
|:----------|----------------------|-----|-----|
| イベントID    | EventId              |     |     |
| 発生日時      | WhenOccurred         |     |     |
| 適用年       | WhenNoticedYear      |     |     |
| 適用年月      | WhenNoticedYearMonth |     |     |
| 適用日時      | WhenNoticed          |     |     |
| PartyId   | partyId              |     |     |
| PlaceId   | PlaceId              |     |     |
| ProductId | ProductId            |     |     |

## 対応表

## 対照表

## サブタイプ

## みなしエンティティ

## viewの検討

* テーブル化しない判断

# データベースの実装

# 付録

その他、データベースの設計に関わる